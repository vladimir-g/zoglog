{% extends "base.html" %}

{% block title %}{% super %} - {{ channel }}/{{ server }}{% endblock %}

{% block center %}

  <div class="page-header">
    <h1>{{ channel }} <small>{{ server }}</small></h1>
  </div>

  <div class="well well-sm">

    <form class="form-inline" method="get" action="">

      <div class="form-group">
        <label class="sr-only" for="nick">Nick</label>
	<div class="input-group">
	  <div class="input-group-addon"><span class="glyphicon glyphicon-user"></span></div>
          <input type="text" class="form-control" id="nick" name="nick"
		 placeholder="Nick" value="{{ nick }}" />
	</div>
      </div>
      <div class="form-group">
        <label class="sr-only" for="host">Host:</label>
        <div class="input-group">
          <input type="text" class="form-control" id="host" name="host"
		 placeholder="user@hostname" value="{{ host }}" />
	</div>
      </div>
      <div class="form-group">
        <label class="sr-only" for="message">Message</label>
        <input type="text" class="form-control" id="message" name="message"
               placeholder="Message" value="{{ message }}" />
      </div>

      <div class="form-group">
        <label class="sr-only" for="date-from">From date:</label>
        <div class="input-group">
          <span class="input-group-addon">
            <span class="glyphicon glyphicon-calendar"></span>
          </span>
          <input type="text" class="form-control datepicker" id="date-from" name="date-from"
		 placeholder="From: 1991-12-26T01:01:01" value="{{ date-from }}" />
	</div>
      </div>

      <div class="form-group">
        <label class="sr-only" for="date-to">To date:</label>
        <div class="input-group">
          <input type="text" class="form-control datepicker" id="date-to" name="date-to"
		 placeholder="To: 2037-06-06T06:06:06" value="{{ date-to }}" />
          <span class="input-group-addon">
            <span class="glyphicon glyphicon-calendar"></span>
          </span>

	</div>
      </div>

      <div class="form-group">
        <label class="sr-only" for="limit">Limit</label>
        <input type="number" class="form-control" id="limit" name="limit"
               min="1" max="{{ max-limit }}" placeholder="Limit" value="{% if limit != default-limit %}{{ limit }}{% endif %}" />
      </div>

      <div class="btn-group btn-group-sm" role="group" aria-label="filter">
        <button type="submit" class="btn btn-primary"><span class="glyphicon glyphicon-search"></span></button>
        <a class="btn btn-danger" href="{{ newest-url }}"><span class="glyphicon glyphicon-remove"></span></a>
      </div>

    </form>
  </div>

  <table class="table table-striped table-hover table-condensed">
    <thead>
      <tr>
	<th class="col-lg-1">Date</th>
	<th class="col-lg-1 col-md-1 col-sm-1 text-right">Nick</th>
	<th>Message</th>
      </tr>
    </thead>
    <tbody>
      {% for message in messages %}

	<tr
           {% if message.message-type == "NOTICE" %} class="info"{% endif %}
	   {% if message.message-type == "ACTION" %} class="warning"{% endif %}
	   {% if message.message-type == "KICK" %} class="danger"{% endif %}>
	   
	   <td class="text-nowrap">
	     <a id="msg-{{ message.id }}" href="#msg-{{ message.id }}">
	       <small>{{ message.date-formatted }}</small>
	     </a>
	   </td>

	   <td class="text-right">
	     {% if message.message-type == "PRIVMSG" or message.message-type == "NOTICE" or message.message-type == "ACTION" %}
	       <strong>{{ message.nick }}</strong>
	     {% endif %}
	   </td>
	   <td class="log-message">
	     {% if message.message-type == "PRIVMSG" or message.message-type == "NOTICE" or message.message-type == "ACTION" %}
	       {{ message.message }}
	     {% else %}
	       <span class="text-muted">{{ message.nick }} ({{ message.host }})

		 {% if message.message-type == "JOIN" %}
		   has joined
		 {% endif %}
		 {% if message.message-type == "QUIT" %}
		   has quit{% if message.message %}: {{ message.message }}{% endif %}
		 {% endif %}
		 {% if message.message-type == "PART" %}
		   has left channel{% if message.message %}: {{ message.message }}{% endif %}
		 {% endif %}
		 {% if message.message-type == "KICK" %}
		   has been kicked{% if message.message %}: {{ message.message }}{% endif %}
		 {% endif %}
		 {% if message.message-type == "NICK" %}
		   is now known as <strong>{{ message.message }}</strong>
		 {% endif %}

	       </span>
	       
	     {% endif %}
	   </td>
	</tr>
      {% endfor %}

    </tbody>
  </table>

  <nav>
    <ul class="pager">
      {% if older-link %}
        <li class="previous">
          <a href="{{ older-link|safe }}">
            Older <span aria-hidden="true">&larr;</span></a>
        </li>
      {% endif %}
      {% if newer-link %}
        <li class="next">
          <a href="{{ newer-link|safe }}">
            <span aria-hidden="true">&rarr;</span>
            Newer</a>
        </li>
      {% endif %}
    </ul>
  </nav>

{% endblock %}
